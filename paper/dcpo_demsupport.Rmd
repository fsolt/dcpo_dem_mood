---
output: 
  bookdown::pdf_document2:
    fig_caption: yes
    keep_tex: yes
    toc: no
    number_sections: yes
    latex_engine: xelatex
    
title: |
  | Democracy, Public Support, 
  | and Measurement Uncertainty
# thanks: "The authors contributed equally to this work.  Corresponding author: [yuehu@mail.tsinghua.edu.cn](mailto:yuehu@mail.tsinghua.edu.cn).  Current version: `r format(Sys.time(), '%B %d, %Y')`."

# author:
# - name: Yuehong 'Cassandra' Tai
#   affiliation: University of Iowa
# - name: Yue Hu
#   affiliation: Tsinghua University
# - name: Frederick Solt
#   affiliation: University of Iowa
  
abstract: "Do democratic regimes depend on public support to avoid backsliding? Does public support, in turn, respond thermostatically to changes in democracy? Two prominent recent studies (Claassen 2020a, 2020b) reinvigorated the classic hypothesis on the positive relationship between public support for democracy and regime survival---and challenged its reciprocal counterpart---by using a latent variable approach to measure mass democratic support from cross-national survey data. But such approaches come with concomitant measurement uncertainty, and neither study incorporated this uncertainty into its analyses. In this letter, we correctly take measurement uncertainty in account and show that there is no support for the conclusion of either study. We then work to minimize the measurement uncertainty in public support by incorporating additional survey data. Even with this expanded evidentiary base, however, our analyses fail to yield evidence in support of either hypothesis, underscoring the necessity of accounting for measurement uncertainty. [144/150 words]"
keywords: "Democratization, public support, regime survival, measurement uncertainty, latent variables"

date: "`r format(Sys.time(), '%B %d, %Y')`"
editor_options: 
  markdown: 
    wrap: sentence
tables: true # enable longtable and booktabs
citation_package: natbib
fontsize: 12pt
indent: true
linestretch: 1.5 # double spacing using linestretch 1.5
bibliography: dcpo_demsupport.bib
# bibliography: \dummy{`r file.path(getwd(), list.files(getwd(), ".bib$", recursive = TRUE))`}
# csl: https://raw.githubusercontent.com/citation-style-language/styles/master/american-political-science-association.csl
biblio-style: apsr
citecolor: black
linkcolor: black
endnote: no
header-includes:
      - \usepackage{array}
      - \usepackage{caption}
      - \usepackage{graphicx}
      - \usepackage{siunitx}
      - \usepackage{colortbl}
      - \usepackage{multirow}
      - \usepackage{hhline}
      - \usepackage{calc}
      - \usepackage{tabularx}
      - \usepackage{threeparttable}
      - \usepackage{wrapfig}
      - \usepackage{fullpage}
      - \usepackage{pdflscape} #\usepackage{lscape} better for printing, page displayed vertically, content in landscape mode, \usepackage{pdflscape} better for screen, page displayed horizontally, content in landscape mode
      - \newcommand{\blandscape}{\begin{landscape}}
      - \newcommand{\elandscape}{\end{landscape}}
      - \usepackage{titlesec}
      - \titleformat*{\section}{\normalsize\bfseries}
      - \titleformat*{\subsection}{\normalsize\itshape}
---

(Word count: 3628)

It has long been argued that democratic regimes and public support for them are mutually reinforcing: that high levels of public support ensure democracies remain strong, and that experience with democratic governance generates robust public support [see, e.g., @lipset_social_1959; @Easton1965].
But the evidence for either part of this claim has been decidedly mixed.
Countries with greater democratic support have been found to become stronger and more stable democracies [e.g., @Inglehart2005, pp. 251-254] and just the opposite [@Fails2010, pp. 182-183].
Similarly, studies have alternately found that more experience with democracy yields more democratic support [e.g., @Fails2010, p. 183; @Wuttke2020a, pp. 5-6] or instead that long-established democracies are suffering from democratic fatigue [e.g., @Denemark2016; @Foa2017].

One important reason for these mixed results is the difficulty in measuring democratic support over time and across many countries.
Public support for democracy cannot be directly observed, and its incorrect measurement will limit inferences about the relationships between public opinion and institutional development.
Further, the survey data available across countries and over time on support for democracy---or indeed most topics in public opinion---are sparse and incomparable, greatly hindering broadly comparative research.
Recently, a few pioneering studies have sought to overcome the hurdle of sparse and incomparable data by developing latent variable measurement models of public opinion [see @Caughey2019; @Claassen2019; @Solt2020a].
A pair of prominent recent works took advantage of this latent variable approach to measure democratic support for over one hundred countries for up to nearly three decades and to then assess, respectively, its consequences for and roots in democratic change [@Claassen2020a; @Claassen2020b].
These works concluded, first and supporting the classic argument, that mass support had a positive impact on democratic change, especially the endurance of democracy [@Claassen2020a, pp. 127-130], and, second and directly contrary to it, democratic change has a thermostatic effect on public support, that is that, rather than generating its own support, deepening democracy provokes a backlash and it is instead democratic backsliding that calls forth greater public support [@Claassen2020b, 46-50].

The models employed in these studies' analyses, though, do not account for uncertainty in their measurement of democratic support.
Measurement error challenges statistical analyses, especially when it is correlated with an outcome variable which is the case of democratic support, but it is often ignored in the analysis [@Blackwell2017; @Blackwell2017a].
Because they are unobserved, latent variables are inherently accompanied by measurement uncertainty.
To leave this uncertainty unacknowledged is to make the implausible assumption that the latent variables are measured perfectly, an assumption which distorts both statistical and substantive inference [see, e.g., @Crabtree2015; @juhl_measurement_2019].

In this letter, we reexamine the classic arguments about support for democracy and democratic change tested in these two pieces while correcting this oversight.
In addition to incorporating the measurement uncertainty, we also sought to reduce it by correcting and expanding survey data to including 144 countries for up to 33 years between 1988 and 2020 (based on 26% more questions and 33% more survey sources).
Our analyses reveal that the significant relationships between public support and democratic change disappear once measurement uncertainty is taken into account, both in replications with the studies' original data and with expanded data.
That is, once measurement uncertainty is accounted for, there is no empirical support for either claim put forward in these two works: declining democratic support does not signal subsequent democratic backsliding, and changes in democracy do not spur a thermostatic response in democratic support.
  
There are several important implications of these null results.
They point to a need for closer attention to the conditional aspects of the classic theory [see @lipset_social_1959, 86-89; @Easton1965, 119-20].
On the one side, the effect of democracy on public support may depend not on its mere existence but on its effectiveness [see @Magalhaes2014] and particularly with regard to redistribution [see @Krieckhaus2014].
On the other, the impact of public support on democracy may depend on the extent to which those who support democracy are also dissatisfied with the current regime's performance; that is, that it is not democratic support that is important to democratic change, but rather unsatisfied democratic demand [see @Qi2011].

Similarly, the results presented here are further evidence that the survey items commonly employed to measure democratic support are inadequate to the task.
Without additional information on respondents' support for democracy relative to other values with which it may come into conflict, such as their partisanship [see, e.g., @Carey2020; @graham_democracy_2020; @McCoy2020]---or on whether respondents even understand the meaning of the democracy they are claiming to support [see, e.g., @Kirsch2019; @Wuttke2020]---these questions appear to miss capturing the true extent of support democracy would find among the public when public support was actually needed [see @Carey2020; @graham_democracy_2020; @McCoy2020].

Our results also reinforce the views that relationships between democracy and public support unfold only over the long term [see, e.g., @Welzel2017] and that democratic change in the short-term is instead best understood as an elite-driven phenomenon [see, e.g., @levitsky_how_2018; @Haggard2021].

We draw two conclusions, one methodological and one substantive.
As latent variable measurement models become more commonly used, it is absolutely necessary for researchers employing them to incorporate the associated uncertainty into analyses.
And, at a time when democracy is seen as under threat around the world [e.g., @Diamond2015], taken together, Claassen [-@Claassen2020a; -@Claassen2020b] send what is ultimately a reassuring message: the fate of democracy rests with us, the public, and when democratic institutions are undermined, we will swing to their support and constitute "an obstacle to democratic backsliding" [@Claassen2020b, p. 51].
Both of these assertions may well be true, but the evidence we have, properly assessed, does not support them.
There is no room for complacency.


```{r setup, include=FALSE}
options(tinytex.verbose = TRUE)

knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  dpi = 300
)

if (!require(pacman)) install.packages("pacman")
library(pacman)

p_install(janitor, force = FALSE)

# ls_pacGH <- c("fsolt/DCPOtools", "sammo3182/drhutools")
# remotes::install_github(ls_pacGH, force = FALSE)


# load all the packages you will use below 
p_load(
  # analysis
  plm, 
  # presentation
  gridExtra,
  # drhutools, # for colorful plots
  dotwhisker, 
  latex2exp,
  # data wrangling
  here,
  broom,
  tidyverse, 
  glue
) 

# Functions preload
set.seed(313)

source(here("R", "tidy_pgmm.r"))
source(here("R", "moc_function.R")) 
source(here("R", "moc_summary.R")) 
source(here("R", "customFunctions.R"))

# dotwhisker::small_multiple() hacks
body(small_multiple)[[17]] <- substitute(
  p <- ggplot(df, aes(y = estimate, ymin = conf.low, ymax = conf.high, 
                      x = as.factor(model), colour = submodel)) +
    do.call(geom_pointrange, point_args) + 
    ylab("") + xlab("") + 
    facet_grid(term ~ .,
               scales = "free",
               labeller = label_parsed,    # enable LaTeX facet labels
               switch = "y") +             # put facet labels on left
    scale_y_continuous(position = "right") # put axis label on right
)

theme_set(theme_bw())
```

```{r data-input, include=FALSE, cache=TRUE}

supdem <- read.csv(here("data", "Support_democracy_ajps.csv"))
sd.plm <- pdata.frame(supdem, index = c("Country", "Year")) 

load(here("data", "correct_cls_ajps.rda")) # https://osf.io/52u7n/download
load(here("data", "correct_cls_apsr.rda")) # https://osf.io/2hwqg/download
load(here("data", "expcor_cls_ajps.rda"))  # https://osf.io/wfm3c/download
load(here("data", "expcor_cls_apsr.rda"))  # https://osf.io/rvc92/download
load(here("data","claassen_replication_input.rda"))
load(here("data","exp_claassen_input.rda"))
#load(here("data","dcpo_apsr.rda"))
#load(here("data","dcpo_ajps.rda"))

result_clsAPSR <- readRDS(here("output", "estimates_clsMeanAPSR.RDS"))
result_clsAJPS <- readRDS(here("output", "estimates_clsMeanAJPS.RDS"))

mocresult_correctAJPS <- readRDS(here("output", "estimates_moc_correctAJPS.RDS")) 
mocresult_expAJPS <- readRDS(here("output", "estimates_moc_expcorAJPS.RDS"))
mocresult_correctAPSR <- readRDS(here("output", "estimates_moc_correctAPSR.RDS"))
mocresult_expAPSR <- readRDS(here("output", "estimates_moc_expcorAPSR.RDS"))
mocdcpo_APSR <- readRDS(here("output","estimates_moc_dcpoAPSR.RDS"))
mocresult_dcpoAJPS <- readRDS(here("output","estimates_moc_dcpoAJPS.RDS"))

```

# Method {-}

We proceed in three steps.
First, we reproduce the original analyses of Claassen [-@Claassen2020a; -@Claassen2020b], which included only the point estimates of the latent variable of democratic support and so exclude its measurement uncertainty.
Second, we collect the original cross-national survey data, replicate the latent variable measure of democratic support used in the two articles, and conduct the articles' analyses again, this time maintaining the entire distribution of estimates of democratic support in each country-year.
As democracy is also a latent variable in these analyses, we include the uncertainty in its estimates as well, along with that for corruption in the second analysis of @Claassen2020b.
In the third step, we collect even more survey data---increasing these source data by one-third---and re-estimate the two articles' analyses once more, again maintaining the full distribution of estimates to preserve measurement uncertainty.^[We also attempted to make fuller use of the available survey data by employing Solt's [-@Solt2020a; -@Solt2020b] DCPO model, which unlike Claassen's [-@Claassen2019] model does not dichotomize ordinal responses.  The better fit of the DCPO model to these data [see @Solt2020a, 10-12] and the additional information it incorporates, however, did not yield substantively different results; see the Supplemental Information.]

## Incorporating Uncertainty {-}

Although measurement uncertainty has not yet attracted attention in the field of comparative public opinion [see, in addition to the works examined here, @OGrady2019], latent variables are estimated with a quantifiable amount of measurement uncertainty, and ignoring that uncertainty in analyses can both attenuate or exaggerate coefficient estimates as well as bias standard errors [see, e.g., @Blackwell2017, 318-319; @Blackwell2017a, 360-361; @caughey2018, 254].
In light of this, recent studies measuring other latent variables have recommended incorporating their measurement uncertainty in analyses [see @solis_measuring_2020, 18; @Gandhi2020, 1553], and research examining the consequences of public opinion in the United States has done so [see, e.g., @Kastellec2015, 791-792; @caughey2018, 254]. 

Therefore, after replicating the original analyses that use only the point estimates for public support and the other variables included in the model, we perform the analyses again only this time incorporating uncertainty in analysis models using our replication data.
We conduct inferences from the distributive data via the technique known as the "method of composition" [@Tanner1993, 52; @Treier2008, 215; @caughey2018, A15-16].
For additional detail on this technique, see the Supplementary Information.

```{r compare_n}

# if (!file.exists(here::here("data", "supdem raw survey marginals.tab"))) {
#   dataverse::get_file("supdem raw survey marginals.tab", "doi:10.7910/DVN/HWLW0J") %>% 
#     read_csv(col_types = "cdcddcdc") %>% 
#     write_csv("data/supdem raw survey marginals.tab")
# }

supdem <- read_csv(here::here("data", "supdem raw survey marginals.tab"),
                   col_types = "cdcddcdc") %>% 
  janitor::clean_names() %>% 
  DCPOtools::with_min_yrs(2)

supdem_ncy <- supdem %>%
  dplyr::select(country, year) %>% 
  distinct() %>% 
  nrow() #1165

supdem_surv <- supdem %>%
  dplyr::select(country, year, project) %>%
  distinct() %>%
  nrow()

supdem_ncyi <- supdem %>%
  dplyr::select(country, year, item) %>% 
  distinct() %>% 
  nrow()

dcpo_input_nc <- exp_claassen_input$data %>% 
  dplyr::select(country) %>% 
  distinct() %>% 
  nrow()

dcpo_input_surv <- exp_claassen_input$data %>%
  dplyr::select(country, year, survey) %>%
  distinct() %>%
  separate(survey, c("surv1", "surv2"), sep=",", fill = "left") %>%
  pivot_longer(cols = starts_with("surv")) %>%
  filter(!is.na(value)) %>% 
  nrow()

dcpo_input_ncy <- exp_claassen_input$data %>% 
  dplyr::select(country, year) %>% 
  distinct() %>% 
  nrow()

dcpo_input_ncyi <- exp_claassen_input$data %>% 
  dplyr::select(country, year, item, survey) %>% 
  distinct() %>% 
  separate(survey, c("surv1", "surv2"), sep=",", fill = "left") %>%
  pivot_longer(cols = starts_with("surv")) %>%
  filter(!is.na(value)) %>% 
  nrow()

increase_cy <- sprintf("%2.1f", (dcpo_input_ncy/supdem_ncy - 1) * 100, 1)
increase_cyi <- sprintf("%2.1f", (dcpo_input_ncyi/supdem_ncyi - 1) * 100, 1)
increase_surv <- sprintf("%2.1f", (dcpo_input_surv/supdem_surv - 1) * 100, 1)
```

## Adding More Data {-}

To provide a further test of the classic arguments on democracy and public support, we generated estimates of democratic support using the same procedure as in Claassen [-@Claassen2020a; -@Claassen2020b] on a bigger data set, assembling as much survey data on democratic support as possible. We employed `r dcpo_input_ncyi` national opinions on democracy from `r dcpo_input_surv` national surveys, representing a `r increase_cyi`% and `r increase_surv`% increase respectively over the `r supdem_ncy` opinions and `r supdem_surv` national surveys used in Claassen [-@Claassen2020a; -@Claassen2020b].^[These figures represent the survey data actually used in estimating public support for democracy; as in Claassen [-@Claassen2020a; -@Claassen2020b], countries for which two separate years of survey data were not available were excluded.]

# Results {-}

Figure \@ref(fig:plot-mainAJPS) presents the reanalyses of the hypothesis that public support influences the level of democracy [@Claassen2020a, Table 1, 128].
The lighter, lefthand set of results replicate the analysis of @Claassen2020a, including its exclusion of measurement uncertainty by using only the point estimates of public democratic support and the other variables measured with quantified error (democracy and corruption), and they reproduce that article's findings.
The middle results introduce a single change: the uncertainty in the measurement of public support is taken into account.
In all four models, the positive coefficients for democratic support are no longer statistically significant.
The darker, righthand results also incorporate uncertainty but additionally replace the estimates of democratic support with those based on our expanded dataset; this change works to increase the number of observations analyzed as well.
Although the confidence intervals shrink considerably, the coefficient estimates move much closer to zero; the hypothesis remains unsupported.

```{r pointAJPS}
ls_iv <- c("plm::lag(SupDem_trim, 1)",
           "plm::lag(SupDem_Democ, 1) + plm::lag(SupDem_Autoc, 1)")

ls_method <- c("plm", "pgmm")

ls_eq <- glue("Libdem_VD ~ plm::lag(Libdem_VD, 1:2) + {ls_iv} + plm::lag(lnGDP_imp, 1) + plm::lag(GDP_imp_grth, 1) + plm::lag(Libdem_regUN, 1) + plm::lag(Pr_Muslim, 1) + plm::lag(Res_cp_WDI_di, 1)") 

ls_mod <- c(
  glue("plm({ls_eq}, model = 'pooling', data = sd.plm)"),
  glue(
    "pgmm({ls_eq} | plm::lag(Libdem_VD, 3:5), data = sd.plm, effect='individual', model='onestep', transformation='ld', indexes=c('Country', 'Year'))"
  )
)

df_result_cls <- map(ls_mod, function(mod) {
  result <- eval(parse(text = mod))
})

tidy_cls <- map(df_result_cls, function(result) {
  df_result <- tidy(result, conf.int = TRUE)
  
  if (class(result) == "plm") {
     mutate(df_result, std.error = vcovBK_se(result))
  } else{
    mutate(df_result, std.error = vcovHC_se(result))
  }
  
})

glance_cls <- map(df_result_cls, function(aResult){
  if(class(aResult) == "plm"){ 
    glance.plm(aResult) # using the customized glance function
  }else{
      glance(aResult)
    }
})

result_clsAJPS <- map2(tidy_cls, glance_cls, ~ list(.x, .y))
names(result_clsAJPS) <- c("pooled", "pooled-regime", "gmm", "gmm-regime")

saveRDS(result_clsAJPS, file = here::here("output", "estimates_clsMeanAJPS.RDS"))  
```

```{r model-AJPS}

#ls_iv <- c("plm::lag(theta, 1)", 
#    "plm::lag(theta_dem, 1) + plm::lag(theta_aut, 1) ") 

ls_iv <- c("plm::lag(SupDem_trim, 1)", 
    "plm::lag(theta_dem_trim, 1) + plm::lag(theta_aut_trim, 1) ") #use trimmed data

ls_method <- c("plm", "pgmm")

ls_eq <- glue("Libdem_VD ~ plm::lag(Libdem_VD, 1:2) + {ls_iv} + plm::lag(lnGDP_imp, 1) + plm::lag(GDP_imp_grth, 1) + plm::lag(Libdem_regUN, 1) + plm::lag(Pr_Muslim, 1) + plm::lag(Res_cp_WDI_di, 1)") 

ls_mod_ajpsCLS <- c(
    glue("plm({ls_eq}, model = 'pooling', data = aData)"),
    glue(
        "pgmm({ls_eq} | plm::lag(Libdem_VD, 3:5), data = aData, effect='individual', model='onestep', transformation='ld', indexes=c('country', 'year'))"
    )
)

```

```{r mocResult-pureAJPS, eval=FALSE}

df_correct_clsAjps <- purrr::map(1:900, function(anEntry) {
  correct_cls_ajps[[anEntry]] %>% 
    plm::pdata.frame(index = c("country", "year"))
})

result_correct_clsUncertain  <- map(ls_mod_ajpsCLS[1:2], function(aMod){
  result <- methodComposition1(df_correct_clsAjps,aMod)
})

names(result_correct_clsUncertain) <- c("pooled", "pooled-regime")


result_correct_clsUncertain_gmm  <- map(ls_mod_ajpsCLS[3:4], function(aMod){
  result <- methodComposition2(df_correct_clsAjps,aMod)
})
names(result_correct_clsUncertain_gmm) <- c("gmm", "gmm-regime")

mocresult_correctAJPS <- append(result_correct_clsUncertain, result_correct_clsUncertain_gmm)


saveRDS(mocresult_correctAJPS, file =here("output","estimates_moc_correctAJPS.RDS"))


```

```{r mocResult-expAJPS, eval=FALSE}

df_exp_clsAjps <- purrr::map(1:900, function(anEntry) {
  expcor_cls_ajps[[anEntry]] %>% 
    plm::pdata.frame(index = c("country", "year"))
})

result_exp_clsUncertain  <- map(ls_mod_ajpsCLS[1:2], function(aMod){
  result <- methodComposition1(df_exp_clsAjps,aMod)
})

names(result_exp_clsUncertain) <- c("pooled", "pooled-regime")

result_exp_clsUncertain_gmm  <- map(ls_mod_ajpsCLS[3:4], function(aMod){
  result <- methodComposition2(df_exp_clsAjps,aMod)
})
names(result_exp_clsUncertain_gmm) <- c("gmm", "gmm-regime")

mocresult_expAJPS <- append(result_exp_clsUncertain, result_exp_clsUncertain_gmm)

saveRDS(mocresult_expAJPS, file =here("output","estimates_moc_expcorAJPS.RDS")) 

```

```{r mocFormatResult-AJPS}
result_pooled <- bind_rows(
    mutate(result_clsAJPS[["pooled"]][[1]][,1:3], submodel = "Point Estimates Only"),
    mutate(MOCsumm(mocresult_correctAJPS[["pooled"]]), submodel = "With Uncertainty"),
    mutate(MOCsumm(mocresult_expAJPS[["pooled"]]), submodel = "Uncertainty & More Data")
) %>% 
    mutate(type = "Pooled~OLS",
           model = "Model 1 (Pooled OLS)")

result_gmm <- bind_rows(
    mutate(result_clsAJPS[["gmm"]][[1]][,1:3], submodel = "Point Estimates Only"),
    mutate(MOCsumm(mocresult_correctAJPS[["gmm"]]), submodel = "With Uncertainty"),
    mutate(MOCsumm(mocresult_expAJPS[["gmm"]]), submodel = "Uncertainty & More Data")
) %>% 
    mutate(type = "System~GMM",
           model = "Model 3 (System GMM)")

result_pooledAJPS <- bind_rows(result_pooled, result_gmm) %>%
    filter(term != "(Intercept)") %>%
    mutate(
        term0 = rep(
            c("Democracy\n (t-1)",
              "Democracy\n (t-2)",
              "Support\n (t-1)",
              "Log GDP\n per capita\n (t-1)",
              "GDP per\n capita growth\n (t-1)",
              "Regional\n democracy\n (t-1)",
              "Percent\n Muslim\n (t-1)",
              "Resource\n dependence\n (t-1)"),
            time = 6), 
        type = factor(type, levels = c("Pooled~OLS", "System~GMM")),
        submodel = factor(submodel, levels = c("Point Estimates Only", "With Uncertainty", "Uncertainty & More Data")),
        model = factor(model, levels = paste0("Model ", rep(1:4), rep(c(" (Pooled OLS)", " (System GMM)"), each = 2)))
    )

result_regime <- bind_rows(
    mutate(result_clsAJPS[["pooled-regime"]][[1]][,1:3], submodel = "Point Estimates Only"),
    mutate(MOCsumm(mocresult_correctAJPS[["pooled-regime"]]), submodel = "With Uncertainty"),
    mutate(MOCsumm(mocresult_expAJPS[["pooled-regime"]]), submodel = "Uncertainty & More Data")
) %>% 
    mutate(type = "Pooled~OLS",
           model = "Model 2 (Pooled OLS)")

result_regimeGmm <- bind_rows(
    mutate(result_clsAJPS[["gmm-regime"]][[1]][,1:3], submodel = "Point Estimates Only"),
    mutate(MOCsumm(mocresult_correctAJPS[["gmm-regime"]]), submodel = "With Uncertainty"),
    mutate(MOCsumm(mocresult_expAJPS[["gmm-regime"]]), submodel = "Uncertainty & More Data")
)%>% 
    mutate(type = "System~GMM",
           model = "Model 4 (System GMM)")

result_regimeAJPS <- bind_rows(result_regime, result_regimeGmm) %>%
    filter(term != "(Intercept)") %>%
    mutate(
        term0 = rep(
            c("Democracy\n (t-1)",
              "Democracy\n (t-2)",
              "Support\n demo only\n (t-1)",
              "Support\n auto only\n (t-1)",
              "Log GDP\n per capita\n (t-1)",
              "GDP per\n capita growth\n (t-1)",
              "Regional\n democracy\n (t-1)",
              "Percent\n Muslim\n (t-1)",
              "Resource\n dependence\n (t-1)"),
            time = 6), 
        type = factor(type, levels = c("Pooled~OLS", "System~GMM")),
        submodel = factor(submodel, levels = c("Point Estimates Only","With Uncertainty", "Uncertainty & More Data")),
        model = factor(model, levels = paste0("Model ", rep(1:4), rep(c(" (Pooled OLS)", " (System GMM)"), each = 2))))

```

```{r mocCoefName-AJPS}
index_coefName <- c(
    `Democracy\n (t-1)` = "Democracy[t-1]",
    `Democracy\n (t-2)` = "Democracy[t-2]",
    `Support\n (t-1)` = "Democratic~Support[t-1]~(all~regimes)",
    `Support\n demo only\n (t-1)` = "Democratic~Support[t-1]~(democracies)",
    `Support\n auto only\n (t-1)` = "Democratic~Support[t-1]~(autocracies)",
    `Log GDP\n per capita\n (t-1)` = "Log~GDP~per~capita[t-1]",
    `GDP per\n capita growth\n (t-1)` = "GDP~per~capita~Growth[t-1]",
    `Regional\n democracy\n (t-1)` = "Regional~Democracy[t-1]",
    `Percent\n Muslim\n (t-1)` = "Percent~Muslim[t-1]",
    `Resource\n dependence\n (t-1)` = "Resource~Dependence[t-1]"
)
```

```{r plot-fullAJPS, fig.cap= "The Effect of Public Support on Democracy with Uncertainty", fig.width=5, fig.height=10, fig.align='center'}

df_plot <- bind_rows(result_pooledAJPS, result_regimeAJPS) %>% 
  mutate(term = index_coefName[term0], 
           term = factor(term, levels = unique(index_coefName)))

ajps_caption <- "Replications of Claassen (2020a), Table 1, 128."

small_multiple(df_plot, dot_args = list(size = .9, fatten = 1)) +
    geom_hline(yintercept = 0, colour = "grey50", linetype = 2) +
    scale_color_grey(start = 0.8, end = 0.4, 
                     name = "Replication",
                     breaks=c("Point Estimates Only", "Uncertainty & More Data", "Uncertainty & DCPO"),
                     labels=c("Point Estimates Only", "Uncertainty & More Data", "Uncertainty & DCPO")) +
    theme(axis.text.x  = element_text(angle = 90, hjust = .5),
          strip.text.y.left = element_text(angle = 0),
          legend.position = c(-0.06, -.01),
          legend.justification = c(1, 1), 
          legend.title = element_text(size = 9, face = "bold"),
          legend.title.align = 0.5,
          legend.text = element_text(size = 9),
          legend.background = element_rect(color="gray90"),
          legend.spacing = unit(-5, "pt"),
          legend.key.size = unit(8, "mm"),
          plot.title = element_text(hjust = 1.4),
          plot.caption = element_text(size = 10, hjust = 0.2, margin = margin(t=15))) +
  guides(color = guide_legend(override.aes = list(size=.3))) +
  ggtitle("Dependent Variable: Level of Democracy") +
  labs(caption = ajps_caption)

```

In Figure \@ref(fig:plot-mainAPSR), we examine the thermostatic model of democratic support per @Claassen2020b [47, Table 1, 49, Table 2].
The negative coefficient estimates for change in liberal democracy in the lefthand set of results, which do not take uncertainty into account, imply that the immediate effect of a increase in the level of democracy is a decline in public support for democracy and of a decrease in democracy an expansion of support---that democratic support indeed does respond thermostatically to democracy. 
However, the middle results demonstrate that this thermostatic effect, too, does not  hold after the measurement uncertainty is accounted for. 
And again, the righthand results reveal that the additional data of our extension do not provide support for the original conclusion.
<!-- In fact, once uncertainty is taken into account, the models of @Claassen2020b detect very little pattern in the year-to-year changes of public support for democracy at all. -->

In short, the conclusions of Claassen [-@Claassen2020a; -@Claassen2020b] that democratic support has a positive effect on democracy and change in democracy a negative effect on change in support are not empirically supported once measurement uncertainty is taken into account, even when more data are used.  

```{r pointAPSR}
# Reusing the sd.plm object, thus input data here rather than earlier

load(here::here("data", "dem_mood_apsr.RData"))
sd.plm <- pdata.frame(x, index = c("Country", "Year")) 

ls_ivECM <- c("diff(Libdem_z, lag = 1) + plm::lag(Libdem_z, 1)", 
              "diff(Polyarchy_z, lag = 1) + plm::lag(Polyarchy_z, 1) + diff(Liberal_z, lag = 1) + plm::lag(Liberal_z, 1)")
ls_ctrlECM <- c("", " + diff(Corrup_TI_z, lag = 1) + plm::lag(Corrup_TI_z, 1)")

ls_eqECM <- glue("diff(SupDem_trim, lag = 1) ~ plm::lag(SupDem_trim, 1:2) + {ls_ivECM} + diff(lnGDP_imp, lag = 1) + plm::lag(lnGDP_imp, 1)") %>% 
  outer(ls_ctrlECM, paste0) %>% 
  as.vector()

ls_ivFD <- c("Libdem_z",
             "Polyarchy_z + Liberal_z")

ls_ctrlFD <- c("", " + Corrup_TI_z")

ls_eqFD <- glue("SupDem_trim ~ {ls_ivFD} + lnGDP_imp") %>% 
  outer(ls_ctrlFD, paste0) %>% 
  as.vector()

ls_mod <- c(
  glue("plm({ls_eqECM}, model = 'pooling', data = sd.plm)"),
  glue("plm({ls_eqFD}, model = 'fd', index = 'Country', data = sd.plm)")
)

df_result_clsAPSR <- map(ls_mod, function(mod) {
  result <- eval(parse(text = mod))
})

result_clsAPSR <- map(df_result_clsAPSR, function(aResult) {
  tidy_result <- tidy(aResult, conf.int = TRUE) %>% 
    mutate(std.error = vcovHC_se(aResult))
  
  glance_result <- glance.plm(aResult)
  
  ls_result <- list(tidy_result, glance_result)
})

names(result_clsAPSR) <- c("pooled1", "pooled-regime1", "pooled2", "pooled-regime2", 
                           "fd1", "fd-regime1", "fd2", "fd-regime2")

saveRDS(result_clsAPSR, file = here("output", "estimates_clsMeanAPSR.RDS"))
```

```{r model-APSR}
ls_ivECM <- c("diff(Libdem_z, lag = 1) + plm::lag(Libdem_z, 1)", 
              "diff(Polyarchy_z, lag = 1) + plm::lag(Polyarchy_z, 1) + diff(Liberal_z, lag = 1) + plm::lag(Liberal_z, 1)")
ls_ctrlECM <- c("", " + diff(Corrup_TI_z, lag = 1) + plm::lag(Corrup_TI_z, 1)")

ls_eqECM <- glue("diff(SupDem_trim, lag = 1) ~ plm::lag(SupDem_trim, 1:2) + {ls_ivECM} + diff(lnGDP_imp, lag = 1) + plm::lag(lnGDP_imp, 1)") %>% 
  outer(ls_ctrlECM, paste0) %>% 
  as.vector()

ls_ivFD <- c("Libdem_z",
             "Polyarchy_z + Liberal_z")

ls_ctrlFD <- c("", " + Corrup_TI_z")

ls_eqFD <- glue("diff(SupDem_trim, lag = 1) ~ {ls_ivFD} + lnGDP_imp") %>% 
  outer(ls_ctrlFD, paste0) %>% 
  as.vector()

ls_mod_apsrCLS <- c(
  glue("plm({ls_eqECM}, model = 'pooling', data = aData)"),
  glue("plm({ls_eqFD}, model = 'fd', index = 'country', data = aData)")
)
```

```{r mocResult-pureAPSR, eval=FALSE}

df_correct_clsAPSR <- purrr::map(1:900, function(anEntry) {
  correct_cls_apsr[[anEntry]] %>% 
    plm::pdata.frame(index = c("country", "year"))
}
)


mocresult_correctAPSR  <- map(ls_mod_apsrCLS, function(aMod){
  result <- methodComposition3(df_correct_clsAPSR,aMod)
})  

 
names(mocresult_correctAPSR) <- c("pooled1", "pooled-regime1", "pooled2", "pooled-regime2",
                                "fd1", "fd-regime1", "fd2", "fd-regime2")


saveRDS(mocresult_correctAPSR, file = here::here("ouput","estimates_moc_correctAPSR.RDS"))


```

```{r mocResult-expAPSR, eval=FALSE}

df_exp_clsAPSR <- purrr::map(1:900, function(anEntry) {
  expcor_cls_apsr[[anEntry]] %>% 
    plm::pdata.frame(index = c("country", "year"))
}
)


mocresult_expAPSR <- map(ls_mod_apsrCLS, function(aMod){
  result <- methodComposition3(df_exp_clsAPSR,aMod)
})  


names(mocresult_expAPSR) <- c("pooled1", "pooled-regime1", "pooled2", "pooled-regime2",
                                "fd1", "fd-regime1", "fd2", "fd-regime2")

saveRDS(mocresult_expAPSR, file = here::here("output","estimates_moc_expcorAPSR.RDS"))


```

```{r mocFormatResult-APSR}
# Pooled---------------------------------------

result_ecm1 <- bind_rows(
    mutate(result_clsAPSR[["pooled1"]][[1]][,1:3], submodel = "Point Estimates Only"),
    mutate(MOCsumm2(mocresult_correctAPSR[["pooled1"]]), submodel = "With Uncertainty"),
    mutate(MOCsumm2(mocresult_expAPSR[["pooled1"]]), submodel = "Uncertainty & More Data")
) %>% 
    mutate(type = "Error-Correction Model",
           model = "Model 1.1 (ECM)")


result_fd1 <- bind_rows(
    mutate(result_clsAPSR[["fd1"]][[1]][,1:3], submodel = "Point Estimates Only"),
    mutate(MOCsumm2(mocresult_correctAPSR[["fd1"]]), submodel = "With Uncertainty"),
    mutate(MOCsumm2(mocresult_expAPSR[["fd1"]]), submodel = "Uncertainty & More Data")
) %>% 
    mutate(type = "First-Difference Model",
           model = "Model 1.3 (FD)")

result_APSR1 <- bind_rows(result_ecm1, result_fd1) %>%
    filter(term != "(Intercept)") %>%
    mutate(
        term0 = c(rep(
            c("Democratic Mood\n (t-1)",
              "Democratic Mood\n (t-2)",
              "Liberal Democracy\n (Difference)",
              "Liberal Democracy\n (t-1)",
              "Log GDP\n per capita\n (Difference)",
              "Log GDP\n (t-1)"),
            time = 3),
            rep(
                c("Liberal Democracy\n (Difference)", 
                  "Log GDP\n per capita\n (Difference)"), 
                time = 3
            )),
        type = factor(type,  levels = c("Error-Correction Model", "First-Difference Model")),
        submodel = factor(submodel, levels = c("Point Estimates Only","With Uncertainty", "Uncertainty & More Data")),
        model = factor(model, levels = paste0("Model ", 
                                              rep(1:2, each = 4), ".", rep(1:4, 2),
                                              " (",
                                              rep(c("ECM", "ECM", "FD", "FD"), 2),
                                              ")"))
    )


# Institution----------------------------------

result_ecmReg1 <- bind_rows(
    mutate(result_clsAPSR[["pooled-regime1"]][[1]][,1:3], submodel = "Point Estimates Only"),
    mutate(MOCsumm2(mocresult_correctAPSR[["pooled-regime1"]]), submodel = "With Uncertainty"),
    mutate(MOCsumm2(mocresult_expAPSR[["pooled-regime1"]]), submodel = "Uncertainty & More Data")
) %>% 
    mutate(type = "Error-Correction Model",
           model = "Model 2.1 (ECM)")


result_fdReg1 <- bind_rows(
    mutate(result_clsAPSR[["fd-regime1"]][[1]][,1:3], submodel = "Point Estimates Only"),
    mutate(MOCsumm2(mocresult_correctAPSR[["fd-regime1"]]), submodel = "With Uncertainty"),
    mutate(MOCsumm2(mocresult_expAPSR[["fd-regime1"]]), submodel = "Uncertainty & More Data")
) %>% 
    mutate(type = "First-Difference Model",
           model = "Model 2.3 (FD)")


result_RegAPSR1 <- bind_rows(result_ecmReg1, result_fdReg1) %>%
    filter(term != "(Intercept)") %>%
    mutate(
        term0 = c(rep(
            c("Democratic Mood\n (t-1)",
              "Democratic Mood\n (t-2)",
              "Electoral Democracy\n (Difference)",
              "Electoral Democracy\n (t-1)",
              "Minoritarian Democracy\n (Difference)",
              "Minoritarian Democracy\n (t-1)",
              "Log GDP\n per capita\n (Difference)",
              "Log GDP\n (t-1)"),
            time = 3),
            rep(
                c("Electoral Democracy\n (Difference)", 
                  "Minoritarian Democracy\n (Difference)",
                  "Log GDP\n per capita\n (Difference)"), 
                time = 3
            )),
        type = factor(type,  levels = c("Error-Correction Model", "First-Difference Model")),
        submodel = factor(submodel, levels = c("Point Estimates Only","With Uncertainty", "Uncertainty & More Data")),
        model = factor(model, levels = paste0("Model ", 
                                              rep(1:2, each = 4), ".", rep(1:4, 2),
                                              " (",
                                              rep(c("ECM", "ECM", "FD", "FD"), 2),
                                              ")"))
    )

# result_apsrRegime <- result_RegAPSR1 %>% 
#     filter(type == "Error-Correction Model") %>% 
#     mutate(type = "Institution Specified")


# Pooled-corruption------------------------------

result_ecm2 <- bind_rows(
    mutate(result_clsAPSR[["pooled2"]][[1]][,1:3], submodel = "Point Estimates Only"),
    mutate(MOCsumm2(mocresult_correctAPSR[["pooled2"]]), submodel = "With Uncertainty"),
    mutate(MOCsumm2(mocresult_expAPSR[["pooled2"]]), submodel = "Uncertainty & More Data")
) %>% 
    mutate(type = "Error-Correction Model",
           model = "Model 1.2 (ECM)")

result_fd2 <- bind_rows(
    mutate(result_clsAPSR[["fd2"]][[1]][,1:3], submodel = "Point Estimates Only"),
    mutate(MOCsumm2(mocresult_correctAPSR[["fd2"]]), submodel = "With Uncertainty"),
    mutate(MOCsumm2(mocresult_expAPSR[["fd2"]]), submodel = "Uncertainty & More Data")
) %>% 
    mutate(type = "First-Difference Model",
           model = "Model 1.4 (FD)")

result_APSR2 <- bind_rows(result_ecm2, result_fd2) %>%
    filter(term != "(Intercept)") %>%
    mutate(
        term0 = c(rep(
            c("Democratic Mood\n (t-1)",
              "Democratic Mood\n (t-2)",
              "Liberal Democracy\n (Difference)",
              "Liberal Democracy\n (t-1)",
              "Log GDP\n per capita\n (Difference)",
              "Log GDP\n (t-1)",
              "Corruption\n (Difference)",
              "Corruption\n (t-1)"
            ),
            time = 3),
            rep(
                c("Liberal Democracy\n (Difference)", 
                  "Log GDP\n per capita\n (Difference)",
                  "Corruption\n (Difference)"), 
                time = 3
            )),
        type = factor(type,  levels = c("Error-Correction Model", "First-Difference Model")),
        submodel = factor(submodel, levels = c("Point Estimates Only","With Uncertainty", "Uncertainty & More Data")),
        model = factor(model, levels = paste0("Model ", 
                                                      rep(1:2, each = 4), ".", rep(1:4, 2),
                                                      " (",
                                                      rep(c("ECM", "ECM", "FD", "FD"), 2),
                                                      ")"))
    )

# Institution Corruption--------------------------------

result_ecmReg2 <- bind_rows(
    mutate(result_clsAPSR[["pooled-regime2"]][[1]][,1:3], submodel = "Point Estimates Only"),
    mutate(MOCsumm2(mocresult_correctAPSR[["pooled-regime2"]]), submodel = "With Uncertainty"),
    mutate(MOCsumm2(mocresult_expAPSR[["pooled-regime2"]]), submodel = "Uncertainty & More Data")) %>%
    mutate(type = "Error-Correction Model",
           model = "Model 2.2 (ECM)")

result_fdReg2 <- bind_rows(
    mutate(result_clsAPSR[["fd-regime2"]][[1]][,1:3], submodel = "Point Estimates Only"),
    mutate(MOCsumm2(mocresult_correctAPSR[["fd-regime2"]]), submodel = "With Uncertainty"),
    mutate(MOCsumm2(mocresult_expAPSR[["fd-regime2"]]), submodel = "Uncertainty & More Data")) %>% 
    mutate(type = "First-Difference Model",
           model = "Model 2.4 (FD)")

result_RegAPSR2 <- bind_rows(result_ecmReg2, result_fdReg2) %>%
    filter(term != "(Intercept)") %>%
    mutate(
        term0 = c(rep(
            c("Democratic Mood\n (t-1)",
              "Democratic Mood\n (t-2)",
              "Electoral Democracy\n (Difference)",
              "Electoral Democracy\n (t-1)",
              "Minoritarian Democracy\n (Difference)",
              "Minoritarian Democracy\n (t-1)",
              "Log GDP\n per capita\n (Difference)",
              "Log GDP\n (t-1)",
              "Corruption\n (Difference)",
              "Corruption\n (t-1)"
            ),
            time = 3),
            rep(
                c("Electoral Democracy\n (Difference)", 
                  "Minoritarian Democracy\n (Difference)",
                  "Log GDP\n per capita\n (Difference)",
                  "Corruption\n (Difference)"), 
                time = 3
            )),
        type = factor(type,  levels = c("Error-Correction Model", "First-Difference Model")),
        submodel = factor(submodel, levels = c("Point Estimates Only","With Uncertainty", "Uncertainty & More Data")),
        model = factor(model, levels = paste0("Model ", 
                                              rep(1:2, each = 4), ".", rep(1:4, 2),
                                              " (",
                                              rep(c("ECM", "ECM", "FD", "FD"), 2),
                                              ")"))
    )
```

```{r mocCoefName-APSR}
index_coefName <- c(
    `Democratic Mood\n (t-1)` = "Democratic~Support[t-1]",
    `Democratic Mood\n (t-2)` = "Democratic~Support[t-2]",
    `Liberal Democracy\n (Difference)` = "Delta~Liberal~democracy",
    `Liberal Democracy\n (t-1)` = "Liberal~Democracy[t-1]",
    `Electoral Democracy\n (Difference)` = "Delta~Electoral~Democracy",
    `Electoral Democracy\n (t-1)` = "Electoral~Democracy[t-1]",
    `Minoritarian Democracy\n (Difference)` = "Delta~Minoritarian~Democracy",
    `Minoritarian Democracy\n (t-1)` = "Minoritarian~Democracy[t-1]",
    `Log GDP\n per capita\n (Difference)` = "Delta~Log~GDP~per~capita",
    `Log GDP\n (t-1)` = "Log~GDP~per~capita[t-1]",
    `Corruption\n (Difference)` = "Delta~Corruption",
    `Corruption\n (t-1)` = "Corruption[t-1]"
)
```

```{r plot-fullAPSR, fig.cap= "The Effect of Democracy on Change in Public Support with Uncertainty", fig.width=7, fig.height=10}
df_plot <- bind_rows(result_APSR1, result_APSR2,
                     result_RegAPSR1, result_RegAPSR2) %>% 
    mutate(term = index_coefName[term0], 
           term = factor(term, levels = unique(index_coefName)))

apsr_caption <- "Replications of Claassen (2020b), Table 1, 47, and Table 2, 49.  Models denoted 'ECM' are error-correction models; those marked 'FD' are first-difference models." %>% 
  strwrap(85) %>% 
  paste0(sep="", collapse="\n")

small_multiple(df_plot, dot_args = list(size = .9, fatten = 1)) +
    geom_hline(yintercept = 0, colour = "grey50", linetype = 2) +
    scale_color_grey(start = 0.8, end = 0.4, 
                     name = "Replication",
                     breaks=c("Point Estimates Only",
                              "With Uncertainty",
                              "Uncertainty & More Data"),
                     labels=c("Point Estimates Only",
                              "With Uncertainty",
                              "Uncertainty & More Data")) +
    theme(axis.text.x  = element_text(angle = 90, hjust = .5),
          strip.text.y.left = element_text(angle = 0),
          legend.position = c(0.006, -.01),
          legend.justification = c(1, 1), 
          legend.title = element_text(size = 9, face = "bold"),
          legend.title.align = 0.5,
          legend.text = element_text(size = 8),
          legend.background = element_rect(color="gray90"),
          legend.spacing = unit(-5, "pt"),
          legend.key.width = unit(4.5, "mm"),
          legend.key.height = unit(7, "mm"),
          plot.caption = element_text(size = 10, hjust = 0.2, margin = margin(t=15))) +
  guides(color = guide_legend(override.aes = list(size=.3))) +
  ggtitle("Dependent Variable: Change in Public Democratic Support") +
  labs(caption = apsr_caption)

```

# Discussion {-}

These null results have a number of important substantive implications.
First, they underscore that recognizing the conditional aspects of the classic argument regarding democracy and democratic support is crucial.
With regard to how levels of democracy affect public support, even the early proponents of the classic argument did not contend that the mere existence of democratic institutions, no matter how consistently feckless and ineffective, would generate support among the public: instead, they maintained, public support would be gained through experience with government performance that was generally effective [@lipset_social_1959, 86-89; @Easton1965, 119-120].
There is some empirical evidence for this, with government effectiveness positively related to public support among democracies and negatively related in non-democracies [@Magalhaes2014]. 
The finding of @Krieckhaus2014 that income inequality is strongly negatively related to public support in democracies suggests that performance regarding redistribution is particularly important.
On the reverse part of the classic argument, @Qi2011 suggests that democratic support alone cannot be expected to generate democratic change and oppose backsliding.
Instead, that work contends, it is the combination of democratic support and dissatisfaction with current regime performance that generates demand for greater democracy.
Whether these conditional relationships exist among the newly available latent-variable data on democracy and democratic support remain questions for future research. 

Further, these null results recommend building recent and more refined conceptualizations of democratic support into our measures.
In other words, the survey items employed by Claassen [-@Claassen2020a; -@Claassen2020b]---which ask respondents to assess the desirability or appropriateness of democracy, to compare democracy to some undemocratic alternative, or to assess one of these alternatives---although often used by researchers, may not capture every aspect of democratic support necessary for it to play its hypothesized roles in the classic theory.
One possibility is that only those who profess to prefer democracy to its alternatives _and also_ value freedom of expression, freedom of association, and pluralism of opinion will take appropriate action when democracy is threatened [see, e.g., @Schedler2007].
Another is that respondents' other values, such as their policy preferences or partisanship, may weigh more heavily than their support for democracy: there is growing evidence that, at least in the United States, there are many for whom these other considerations excuse substantial transgressions against democracy [see @bartels_ethnic_2020; @Carey2020; @graham_democracy_2020; @McCoy2020].
Yet another is that the answers to the above items reflect actual support for democracy only when respondents also either hold a robust understanding of what liberal democracy means or anchor their support in emancipative values of universal freedoms.
If they do not, their positive responses to these items indicate support for autocracy instead [see, e.g., @Brunkert2019; @Kirsch2019; @Wuttke2021].
Taking any or all of these into account requires considering the _combination_ of attitudes: even the inclusion of additional questions in a unidimensional public opinion model such as that provided by @Claassen2019 will not be sufficient [see, e.g., @Wuttke2020].

Finally, by failing to provide evidence for a short-term relationship between democratic support and democracy, these null findings can be seen to lend additional support to other theories of regime change.
There are compelling arguments that episodes of democratic transition [see, e.g., @ODonnell1986a; @Karl1987] and backsliding [see, e.g., @levitsky_how_2018; @Haggard2021] are best understood as products of elite decision making.
With regard to the latter, critics have charged that these claims overlook the extent of demand for authoritarian rule among the public [see, e.g., @Norris2021].
The null results reported here, by finding that year-to-year changes in democratic support bear little relationship to changes in democracy, highlight that levels of public support appear to relate to regime only over the long run [see also @Welzel2017], leaving elite decisions as a powerful explanation for when and how short-term developments unfold.


# Conclusion {-}

In this letter, we reexamined the findings from Claassen [-@Claassen2020a; -@Claassen2020b], two articles that maintain that public support helps the survival of democracy and democratic development has a thermostatic effect on public support.
We demonstrated the importance of incorporating measurement uncertainty in analyzing the relationship between public support and democracy.
Taking uncertainty into account rendered both articles' conclusions without empirical support, even when we added a considerable quantity of additional data.

This points to the absolute necessity of incorporating measurement uncertainty into analyses that include latent variables.
As the use of latent variables grows more common in political science, both researchers and readers should be aware that these variables' concomitant measurement uncertainty cannot be neglected.

The null results reached in this letter have several substantive implications.
They highlight theoretical arguments that maintain that levels of democratic support undergird democracy only over the long term and so lend indirect support to other explanations for short-run changes in regime.
They also draw attention to the conditional nature of the classic argument on democracy and democratic support as well as to challenges in measuring the concept of democratic support that remain unmet by existing time-series cross-sectional latent-variable models.
Most importantly, the sanguine assessment that readers may draw from Claassen [-@Claassen2020a; -@Claassen2020b]---that the fate of democracies depend on public support, and when eroded, their publics will rally to them---is not supported by the current evidence.
Those who would defend democracy have no grounds to be complacent.


# References  {-}

<div id = 'refs'></div>

\pagebreak


# Online Supplementary Information {-}
# (APPENDIX) Appendix {-}

\setcounter{page}{1}
\renewcommand{\thepage}{A\arabic{page}}
\setcounter{figure}{0}
\renewcommand{\thefigure}{A.\arabic{figure}}

# Data Recollection and Uncertainty in Control Variables {#dgp}

Due to revisions to the underlying datasets (and, possibly, transcription errors), we were not able to achieve a primary replication [@Grossman2020] based on survey data summarized in @Claassen2020a and @Claassen2020b's Dataverse files.

Specifically, we are not able to identify 5 country-year surveys, including South Sudan in Arab Barometer Wave 4, Dominican Republic in 2003 Latinobarometer, XXXX, and Spain in 2005 Latinobarometer. 
In addition, we still have different sample size and number of respondents answering supportively by following approaches of cleanning data and treatment of non-responses described in @Claassen2020a's supplementatry materials.
Specifically, we used Claassen's year coding to recode 85 unmatching country-year observations and added one more item "strong leader 2" in Arabbarometer which has different response categories but was conflated into "strong leader 1".  

V-Dem data was standardized in @Claassen2020b's analyses, but we did not figure out how the standardization was exactly performed.
We standardized variables using Z-score, and the standardized values are different from Claassen's data.

Since many variables, dependent variables, key independent variables, and control variables in the original analysis are latent variables, which cannot be observed directly and are inherently contaminated by measurement errors.
We include measurement errors in five variables, public support for democracy, liberal democracy index, electoral democracy index, liberal component index, and corruption perception index.

In respect of the key independent variable, public support for democracy, we preserve its posterior distribution from Model 5 using recollected and expanded data, separately.

For the three indices of democratic development, we take two strategies.
Regarding original data and recollected data, we use three democratic indices from V-Dem Version 8 which covers 201 countries from 1789 to 2017 and is the version Claassen used in his analyses.
We use their posterior distribution provided by @coppedge2018.
Regarding the expanded data used to replicate Claassen's analyses, we use the same three democratic indices but from V-Dem Version 10 because its year range from 1789 to 2019 is compatible with the expanded data.
However, since V-Dem project has not released posterior distributions for indices in version 10, we simulated 900 data set for each democracy index using their standard error.

Finally, to account for measurement error in Corruption Perceptions Index, we simulated 900 draws from a distribution with the point estimate and standard error provided by CPI for the year from 2012 to 2018.
However, CPI does not provide standard error for the years before 2012.
To simulate "posterior distribution", we first estimated the standard error for the country-year index.
For each country, we identified its maximum relative standard error (standard error/cpi index) during these years and then calculated the estimated country-year standard error by multiplying the country's maximum relative error and its year CPI index.
We used this estimated standard error to simulate 900 draws for each country-year.

In the following section, we illustrate how we utilize these simulated distributions to take uncertainty into account in analysis models.

# The Method of Composition {#moc}

In analysis models, we have latent variables in both sides of equations, public support for democracy, democracy indices, and corruption index (The latter one is included in APSR analyses).
Since measurement uncertainty associated with these latent variables can propagate into the inferences over coefficient parameters in models, we incorporate uncertainty by employing "Method of Composition" [@Tanner1993,p52], which has been applied in analyses with latent variables [@Treier2008;@caughey2018;@Kastellec2015].

As @caughey2018 explained, the main idea of MOC is to estimate the marginal distribution of coefficient parameter vector $\beta$, integrating over the uncertainty in latent variables $\theta$ (P A-15).
More explicitly, we wish to integrate the joint density of $\beta$ and $\theta$ over the distribution of $\theta$.

\begin{equation}
p(\beta,\theta|w,y, Z) = p(\beta|\theta,w,y)p(\theta|Z).
\end{equation}

where $\theta$ is latent varibles with measurement errors conditional on data Z and a measurement model, $w$ is other predictors without errors, $Z$ is indicators for latent variables $X$, and $y$ is the outcome variable.
In this way, we incorportate uncertainty in measuring predictor $\theta$, and uncertainty in the effects of latent variables $\theta$ and other variables $w$ on outcome variable $y$ [@Treier2008, 215].
To sample from the conditional dentsity and the marginal density in the right side of the equation, we follow iterative Monte Carlo procdure described by @Treier2008, at iteration t,

1. We sample $\theta^{s}$ from its posterior distribution $p(\theta|Z)$ and $y$ from $p(y|Z)$.

2. For each analysis model, we run the model with $y$, $\theta$, and $w$, and save the coefficient estimates $\beta^{s}$ and variance-covariance matrix of $\beta^{s}$, $V^{s}$, both of which change due to the uncertainty in $\theta^{s}$ and $y^{s}$.

3. We sample $\tilde{\beta^{t}}$ from the multivariate normal density with mean vector $\beta{s}$ and variance-covariace matrix $V^{s}$.

We incorporate uncertainty for five variables, public support for democracy, liberal democracy, electoral democracy, liberal component index, and corruption perceptions index.
For each of these five latent variables, we take 900 draws from its posterior distribution. We duplicate the dataset of variables without measurement error 900 times, and assign them to each a different random draw from the distributions of variables with measurement error, which yields 900 dataset.
In next step, we run each of analysis models with these 900 datesets independently and save the resulting estimates of coefficients and the matrix of variance-covariance for each run.
We then draw one sample from the mulitivariate normal distribution with the mean vector of coefficient estimates and variance-covariance matrix produced from each run.
This procedure finally yields 900 samples of estimated coefficients drawn from the joint density of $\beta$ and $\theta$.
We calculate point estimates and standard error based on these 900 samples.


# DCPO Replication {#dcpo}

As a further test of the classic arguments on democracy and public support, we apply the superior DCPO model to a bigger data set.
The DCPO model has several advantages over the @Claassen2019 model used in Claassen [-@Claassen2020a; -@Claassen2020b].
First, while the @Claassen2019 model dichotomizes responses and so discards some information provided by 50 of the 52 survey items employed in Claassen [-@Claassen2020a; -@Claassen2020b], the DCPO model makes use of all of the information available from these ordinal items [@Solt2020a, p.5].
Second, as the DCPO model includes both parameters for the dispersion of each survey item and for the standard deviation of aggregate public opinion in each country-year, it is a complete population-level item-response model and so, unlike the @Claassen2019 model, is explicitly derived from an individual-level model of survey responses [@Solt2020a, pp.3-4; see also @McGann2014].
Third, to produce more sensible estimates of uncertainty for observations at the extremes of the scale [see @Linzer2015, p.229], the DCPO model places bounds on its estimates of public opinion [@Solt2020a, p.8].
Further commending the DCPO model to us---and demonstrating that its advantages make a difference---the validation tests in @Solt2020a [, pp.10-12] reveal that it fits survey data on democratic support better than the @Claassen2019 model does.

We employ the superior DCPO model to the expanded data using the `DCPO` package for R [@Solt2020b].
We use the estimated public support from DCPO model to replicate analyses by following the same steps.
Then, we compare the DCPO results with two types of replication results from Model 5: estimation of original data and without uncertainty and estimation of expanded data and with uncertainty.

The comparison is presented in Appendix B.
Still, even with the superior DCPO model and expanded data, there is no evidence to support that public support can sustain democratic development or public support responds thermostatically to changes in democracy.


```{r dcpo-AJPS, eval=FALSE}

dcpo_Ajps <- purrr::map(1:900, function(anEntry) {
  dcpo_ajps[[anEntry]] %>% 
    plm::pdata.frame(index = c("country", "year")) %>%
    rename(SupDem_trim =theta_trim,
           Regime_VD = Vdem_regime,
           Pr_Muslim = muslism_prop_2010,
           Res_cp_WDI_di = dependence_pc_di,
           lnGDP_imp = lg_imp_mdpgdp,
           GDP_imp_grth = mdprgdp_grwth,
           firstyear = first_year,
           Libdem_VD = Vdem_libdem,
           Libdem_m1 = Vdem_libdem_m1,
           Libdem_m2 = Vdem_libdem_m2,
           ChgDem = Chgdem,
           UpChgDem = upchgdem,
           DwnChgDem = downchgdem,
           Libdem_regUN = Region_libdem,
           Libdem_regUN_m1 = Region_libdem_m1)
})

result_dcpoUncertain  <- map(ls_mod_ajpsCLS[1:2], function(aMod){
  result <- methodComposition1(dcpo_Ajps,aMod)
})

names(result_dcpoUncertain) <- c("pooled", "pooled-regime")


result_dcpoUncertain_gmm  <- map(ls_mod_ajpsCLS[3:4], function(aMod){
  result <- methodComposition2(dcpo_Ajps,aMod)
})
names(result_dcpoUncertain_gmm) <- c("gmm", "gmm-regime")

mocresult_dcpoAJPS <- append(result_dcpoUncertain, result_dcpoUncertain_gmm)
saveRDS(mocresult_dcpoAJPS, file =here("output","estimates_moc_dcpoAJPS.RDS"))

```

```{r dcpoFormatResult-AJPS}
result_pooled <- bind_rows(
    mutate(result_clsAJPS[["pooled"]][[1]][,1:3], submodel = "Point Estimates Only"),
    mutate(MOCsumm(mocresult_expAJPS[["pooled"]]), submodel = "Uncertainty & More Data"),
    mutate(MOCsumm(mocresult_dcpoAJPS[["pooled"]]), submodel = "Uncertainty & DCPO")
) %>% 
    mutate(type = "Pooled~OLS",
           model = "Model 1 (Pooled OLS)")

result_gmm <- bind_rows(
    mutate(result_clsAJPS[["gmm"]][[1]][,1:3], submodel = "Point Estimates Only"),
    mutate(MOCsumm(mocresult_expAJPS[["gmm"]]), submodel = "Uncertainty & More Data"),
    mutate(MOCsumm(mocresult_dcpoAJPS[["gmm"]]), submodel = "Uncertainty & DCPO")
) %>% 
    mutate(type = "System~GMM",
           model = "Model 3 (System GMM)")

result_pooledAJPS <- bind_rows(result_pooled, result_gmm) %>%
    filter(term != "(Intercept)") %>%
    mutate(
        term0 = rep(
            c("Democracy\n (t-1)",
              "Democracy\n (t-2)",
              "Support\n (t-1)",
              "Log GDP\n per capita\n (t-1)",
              "GDP per\n capita growth\n (t-1)",
              "Regional\n democracy\n (t-1)",
              "Percent\n Muslim\n (t-1)",
              "Resource\n dependence\n (t-1)"),
            time = 6), 
        type = factor(type, levels = c("Pooled~OLS", "System~GMM")),
        submodel = factor(submodel, levels = c("Point Estimates Only", "Uncertainty & More Data", "Uncertainty & DCPO")),
        model = factor(model, levels = paste0("Model ", rep(1:4), rep(c(" (Pooled OLS)", " (System GMM)"), each = 2)))
    )

result_regime <- bind_rows(
    mutate(result_clsAJPS[["pooled-regime"]][[1]][,1:3], submodel = "Point Estimates Only"),
    mutate(MOCsumm(mocresult_expAJPS[["pooled-regime"]]), submodel = "Uncertainty & More Data"),
  mutate(MOCsumm(mocresult_dcpoAJPS[["pooled-regime"]]), submodel = "Uncertainty & DCPO")
) %>% 
    mutate(type = "Pooled~OLS",
           model = "Model 2 (Pooled OLS)")

result_regimeGmm <- bind_rows(
    mutate(result_clsAJPS[["gmm-regime"]][[1]][,1:3], submodel = "Point Estimates Only"),
    mutate(MOCsumm(mocresult_expAJPS[["gmm-regime"]]), submodel = "Uncertainty & More Data"),
 mutate(MOCsumm(mocresult_dcpoAJPS[["gmm-regime"]]), submodel = "Uncertainty & DCPO")
)%>% 
    mutate(type = "System~GMM",
           model = "Model 4 (System GMM)")

result_regimeAJPS <- bind_rows(result_regime, result_regimeGmm) %>%
    filter(term != "(Intercept)") %>%
    mutate(
        term0 = rep(
            c("Democracy\n (t-1)",
              "Democracy\n (t-2)",
              "Support\n demo only\n (t-1)",
              "Support\n auto only\n (t-1)",
              "Log GDP\n per capita\n (t-1)",
              "GDP per\n capita growth\n (t-1)",
              "Regional\n democracy\n (t-1)",
              "Percent\n Muslim\n (t-1)",
              "Resource\n dependence\n (t-1)"),
            time = 6), 
        type = factor(type, levels = c("Pooled~OLS", "System~GMM")),
        submodel = factor(submodel, levels = c("Point Estimates Only", "Uncertainty & More Data", "Uncertainty & DCPO")),
        model = factor(model, levels = paste0("Model ", rep(1:4), rep(c(" (Pooled OLS)", " (System GMM)"), each = 2))))

```

```{r dcopCoefName-AJPS}
index_coefName <- c(
    `Democracy\n (t-1)` = "Democracy[t-1]",
    `Democracy\n (t-2)` = "Democracy[t-2]",
    `Support\n (t-1)` = "Democratic~Support[t-1]~(all~regimes)",
    `Support\n demo only\n (t-1)` = "Democratic~Support[t-1]~(democracies)",
    `Support\n auto only\n (t-1)` = "Democratic~Support[t-1]~(autocracies)",
    `Log GDP\n per capita\n (t-1)` = "Log~GDP~per~capita[t-1]",
    `GDP per\n capita growth\n (t-1)` = "GDP~per~capita~Growth[t-1]",
    `Regional\n democracy\n (t-1)` = "Regional~Democracy[t-1]",
    `Percent\n Muslim\n (t-1)` = "Percent~Muslim[t-1]",
    `Resource\n dependence\n (t-1)` = "Resource~Dependence[t-1]"
)
```

```{r plot-dcpoAJPS, fig.cap= "The Effect of Public Support on Democracy", fig.width=5, fig.height=10, fig.align='center'}
df_plot <- bind_rows(result_pooledAJPS, result_regimeAJPS) %>% 
  mutate(term = index_coefName[term0], 
           term = factor(term, levels = unique(index_coefName)))

ajps_caption <- "Replications of Claassen (2020a), Table 1, 128, with DCPO."

small_multiple(df_plot, dot_args = list(size = .9, fatten = 1)) +
    geom_hline(yintercept = 0, colour = "grey50", linetype = 2) +
    scale_color_grey(start = 0.8, end = 0.4, 
                     name = "Replication",
                     breaks=c("Point Estimates Only", "With Uncertainty", "Uncertainty & More Data"),
                     labels=c("Point Estimates Only", "With Uncertainty", "Uncertainty & More Data")) +
    theme(axis.text.x  = element_text(angle = 90, hjust = .5),
          strip.text.y.left = element_text(angle = 0),
          legend.position = c(-0.06, -.01),
          legend.justification = c(1, 1), 
          legend.title = element_text(size = 9, face = "bold"),
          legend.title.align = 0.5,
          legend.text = element_text(size = 9),
          legend.background = element_rect(color="gray90"),
          legend.spacing = unit(-5, "pt"),
          legend.key.size = unit(8, "mm"),
          plot.title = element_text(hjust = 1.4),
          plot.caption = element_text(size = 10, hjust = 0.7, margin = margin(t=15))) +
  guides(color = guide_legend(override.aes = list(size=.3))) +
  ggtitle("Dependent Variable: Level of Democracy") +
  labs(caption = ajps_caption)
```

```{r dcpo-APSR, eval=FALSE}
dcpo_APSR <- purrr::map(1:900, function(anEntry) {
  dcpo_apsr[[anEntry]] %>%
    plm::pdata.frame(index = c("country", "year")) %>%
    rename(
      SupDem_trim = theta_trim,
      First_yr = first_year,
      Libdem_z = Vdem_libdem_z,
      Polyarchy_z = Vdem_polyarchy_z,
      Liberal_z = Vdem_liberal_z,
      Corrup_TI_z = corruption_z,
      lnGDP_imp = lg_imp_mdpgdp
    )
})


mocdcpo_APSR  <- map(ls_mod_apsrCLS, function(aMod) {
  result <- methodComposition3(dcpo_APSR, aMod)
})

names(mocdcpo_APSR) <-
  c(
    "pooled1",
    "pooled-regime1",
    "pooled2",
    "pooled-regime2",
    "fd1",
    "fd-regime1",
    "fd2",
    "fd-regime2"
  )

saveRDS(mocdcpo_APSR,
        file = here::here("output", "estimates_moc_dcpoAPSR.RDS"))
```

```{r dcpoFormatResult-APSR}
# Pooled---------------------------------------

result_ecm1 <- bind_rows(
    mutate(result_clsAPSR[["pooled1"]][[1]][, 1:3], submodel = "Point Estimates Only"),
    mutate(MOCsumm2(mocresult_expAPSR[["pooled1"]]), submodel = "Uncertainty & More Data"),
    mutate(MOCsumm2(mocdcpo_APSR[["pooled1"]]), submodel = "Uncertainty & DCPO")
) %>%
    mutate(type = "Error-Correction Model",
           model = "Model 1.1 (ECM)")

result_fd1 <- bind_rows(
    mutate(result_clsAPSR[["fd1"]][[1]][, 1:3], submodel = "Point Estimates Only"),
    mutate(MOCsumm2(mocresult_expAPSR[["fd1"]]), submodel = "Uncertainty & More Data"),
    mutate(MOCsumm2(mocdcpo_APSR[["fd1"]]), submodel = "Uncertainty & DCPO")
) %>%
    mutate(type = "First-Difference Model",
           model = "Model 1.3 (FD)")

result_APSR1 <- bind_rows(result_ecm1, result_fd1) %>%
    filter(term != "(Intercept)") %>%
    mutate(
        term0 = c(rep(
            c(
                "Democratic Mood\n (t-1)",
                "Democratic Mood\n (t-2)",
                "Liberal Democracy\n (Difference)",
                "Liberal Democracy\n (t-1)",
                "Log GDP\n per capita\n (Difference)",
                "Log GDP\n (t-1)"
            ),
            time = 3
        ),
        rep(
            c(
                "Liberal Democracy\n (Difference)",
                "Log GDP\n per capita\n (Difference)"
            ),
            time = 3
        )),
        type = factor(
            type,
            levels = c("Error-Correction Model", "First-Difference Model")
        ),
        submodel = factor(
            submodel,
            levels = c(
                "Point Estimates Only",
                "Uncertainty & More Data",
                "Uncertainty & DCPO"
            )
        ),
        model = factor(model, levels = paste0(
            "Model ",
            rep(1:2, each = 4), ".", rep(1:4, 2),
            " (",
            rep(c("ECM", "ECM", "FD", "FD"), 2),
            ")"
        ))
    )


# Institution----------------------------------

result_ecmReg1 <- bind_rows(
    mutate(result_clsAPSR[["pooled-regime1"]][[1]][,1:3], submodel = "Point Estimates Only"),
    mutate(MOCsumm2(mocresult_expAPSR[["pooled-regime1"]]), submodel = "Uncertainty & More Data"),
  mutate(MOCsumm2(mocdcpo_APSR[["pooled-regime1"]]), submodel = "Uncertainty & DCPO")
) %>% 
    mutate(type = "Error-Correction Model",
           model = "Model 2.1 (ECM)")

result_fdReg1 <- bind_rows(
    mutate(result_clsAPSR[["fd-regime1"]][[1]][,1:3], submodel = "Point Estimates Only"),
    mutate(MOCsumm2(mocresult_expAPSR[["fd-regime1"]]), submodel = "Uncertainty & More Data"),
  mutate(MOCsumm2(mocdcpo_APSR[["fd-regime1"]]), submodel = "Uncertainty & DCPO")
) %>% 
    mutate(type = "First-Difference Model",
           model = "Model 2.3 (FD)")

result_RegAPSR1 <- bind_rows(result_ecmReg1, result_fdReg1) %>%
    filter(term != "(Intercept)") %>%
    mutate(
        term0 = c(rep(
            c("Democratic Mood\n (t-1)",
              "Democratic Mood\n (t-2)",
              "Electoral Democracy\n (Difference)",
              "Electoral Democracy\n (t-1)",
              "Minoritarian Democracy\n (Difference)",
              "Minoritarian Democracy\n (t-1)",
              "Log GDP\n per capita\n (Difference)",
              "Log GDP\n (t-1)"),
            time = 3),
            rep(
                c("Electoral Democracy\n (Difference)", 
                  "Minoritarian Democracy\n (Difference)",
                  "Log GDP\n per capita\n (Difference)"), 
                time = 3
            )),
        type = factor(type,  levels = c("Error-Correction Model", "First-Difference Model")),
        submodel = factor(submodel, levels = c("Point Estimates Only", "Uncertainty & More Data", "Uncertainty & DCPO")),
        model = factor(model, levels = paste0("Model ", 
                                              rep(1:2, each = 4), ".", rep(1:4, 2),
                                              " (",
                                              rep(c("ECM", "ECM", "FD", "FD"), 2),
                                              ")"))
    )


# Pooled-corruption------------------------------

result_ecm2 <- bind_rows(
    mutate(result_clsAPSR[["pooled2"]][[1]][,1:3], submodel = "Point Estimates Only"),
    mutate(MOCsumm2(mocresult_expAPSR[["pooled2"]]), submodel = "Uncertainty & More Data"),
  mutate(MOCsumm2(mocdcpo_APSR[["pooled2"]]), submodel = "Uncertainty & DCPO")
) %>% 
    mutate(type = "Error-Correction Model",
           model = "Model 1.2 (ECM)")

result_fd2 <- bind_rows(
    mutate(result_clsAPSR[["fd2"]][[1]][,1:3], submodel = "Point Estimates Only"),
    mutate(MOCsumm2(mocresult_expAPSR[["fd2"]]), submodel = "Uncertainty & More Data"),
  mutate(MOCsumm2(mocdcpo_APSR[["fd2"]]), submodel = "Uncertainty & DCPO")
) %>% 
    mutate(type = "First-Difference Model",
           model = "Model 1.4 (FD)")

result_APSR2 <- bind_rows(result_ecm2, result_fd2) %>%
    filter(term != "(Intercept)") %>%
    mutate(
        term0 = c(rep(
            c("Democratic Mood\n (t-1)",
              "Democratic Mood\n (t-2)",
              "Liberal Democracy\n (Difference)",
              "Liberal Democracy\n (t-1)",
              "Log GDP\n per capita\n (Difference)",
              "Log GDP\n (t-1)",
              "Corruption\n (Difference)",
              "Corruption\n (t-1)"
            ),
            time = 3),
            rep(
                c("Liberal Democracy\n (Difference)", 
                  "Log GDP\n per capita\n (Difference)",
                  "Corruption\n (Difference)"), 
                time = 3
            )),
        type = factor(type,  levels = c("Error-Correction Model", "First-Difference Model")),
        submodel = factor(submodel, levels = c("Point Estimates Only", "Uncertainty & More Data","Uncertainty & DCPO")),
        model = factor(model, levels = paste0("Model ", 
                                                      rep(1:2, each = 4), ".", rep(1:4, 2),
                                                      " (",
                                                      rep(c("ECM", "ECM", "FD", "FD"), 2),
                                                      ")"))
    )

# Institution Corruption--------------------------------

result_ecmReg2 <- bind_rows(
    mutate(result_clsAPSR[["pooled-regime2"]][[1]][,1:3], submodel = "Point Estimates Only"),
    mutate(MOCsumm2(mocresult_expAPSR[["pooled-regime2"]]), submodel = "Uncertainty & More Data"),
  mutate(MOCsumm2(mocdcpo_APSR[["pooled-regime2"]]), submodel = "Uncertainty & DCPO")) %>%
    mutate(type = "Error-Correction Model",
           model = "Model 2.2 (ECM)")

result_fdReg2 <- bind_rows(
    mutate(result_clsAPSR[["fd-regime2"]][[1]][,1:3], submodel = "Point Estimates Only"),
    mutate(MOCsumm2(mocresult_expAPSR[["fd-regime2"]]), submodel = "Uncertainty & More Data"),
  mutate(MOCsumm2(mocdcpo_APSR[["fd-regime2"]]), submodel = "Uncertainty & DCPO")) %>% 
    mutate(type = "First-Difference Model",
           model = "Model 2.4 (FD)")


result_RegAPSR2 <- bind_rows(result_ecmReg2, result_fdReg2) %>%
    filter(term != "(Intercept)") %>%
    mutate(
        term0 = c(rep(
            c("Democratic Mood\n (t-1)",
              "Democratic Mood\n (t-2)",
              "Electoral Democracy\n (Difference)",
              "Electoral Democracy\n (t-1)",
              "Minoritarian Democracy\n (Difference)",
              "Minoritarian Democracy\n (t-1)",
              "Log GDP\n per capita\n (Difference)",
              "Log GDP\n (t-1)",
              "Corruption\n (Difference)",
              "Corruption\n (t-1)"
            ),
            time = 3),
            rep(
                c("Electoral Democracy\n (Difference)", 
                  "Minoritarian Democracy\n (Difference)",
                  "Log GDP\n per capita\n (Difference)",
                  "Corruption\n (Difference)"), 
                time = 3
            )),
        type = factor(type,  levels = c("Error-Correction Model", "First-Difference Model")),
        submodel = factor(submodel, levels = c("Point Estimates Only", "Uncertainty & More Data", "Uncertainty & DCPO")),
        model = factor(model, levels = paste0("Model ", 
                                              rep(1:2, each = 4), ".", rep(1:4, 2),
                                              " (",
                                              rep(c("ECM", "ECM", "FD", "FD"), 2),
                                              ")"))
    )
```

```{r dcpoCoefName-APSR}
index_coefName <- c(
    `Democratic Mood\n (t-1)` = "Democratic~Support[t-1]",
    `Democratic Mood\n (t-2)` = "Democratic~Support[t-2]",
    `Liberal Democracy\n (Difference)` = "Delta~Liberal~democracy",
    `Liberal Democracy\n (t-1)` = "Liberal~Democracy[t-1]",
    `Electoral Democracy\n (Difference)` = "Delta~Electoral~Democracy",
    `Electoral Democracy\n (t-1)` = "Electoral~Democracy[t-1]",
    `Minoritarian Democracy\n (Difference)` = "Delta~Minoritarian~Democracy",
    `Minoritarian Democracy\n (t-1)` = "Minoritarian~Democracy[t-1]",
    `Log GDP\n per capita\n (Difference)` = "Delta~Log~GDP~per~capita",
    `Log GDP\n (t-1)` = "Log~GDP~per~capita[t-1]",
    `Corruption\n (Difference)` = "Delta~Corruption",
    `Corruption\n (t-1)` = "Corruption[t-1]"
)
```

```{r plot-dcpoAPSR, fig.cap= "The Effect of Democracy on the Change of Public Support", fig.width=7, fig.height=10}
df_plot <- bind_rows(result_APSR1, result_APSR2,
                     result_RegAPSR1, result_RegAPSR2) %>% 
    mutate(term = index_coefName[term0], 
           term = factor(term, levels = unique(index_coefName)))

apsr_caption <- "Replications of Claassen (2020b), Table 1-2, 47-49 with DCPO.  Models denoted 'ECM' are error-correction models; those marked 'FD' are first-difference models." %>% 
  strwrap(85) %>% 
  paste0(sep="", collapse="\n")

small_multiple(df_plot, dot_args = list(size = .9, fatten = 1)) +
    theme_bw() +
    geom_hline(yintercept = 0, colour = "grey50", linetype = 2) +
    scale_color_grey(start = 0.8, end = 0.4, 
                     name = "Replication",
                     breaks=c("Point Estimates Only",
                              "Uncertainty & More Data",
                              "Uncertainty & DCPO"),
                     labels=c("Point Estimates Only",
                              "Uncertainty & More Data",
                              "Uncertainty & DCPO")) +
    theme(axis.text.x  = element_text(angle = 90, hjust = .5),
          strip.text.y.left = element_text(angle = 0),
          legend.position = c(0.006, -.01),
          legend.justification = c(1, 1), 
          legend.title = element_text(size = 9, face = "bold"),
          legend.title.align = 0.5,
          legend.text = element_text(size = 8),
          legend.background = element_rect(color="gray90"),
          legend.spacing = unit(-5, "pt"),
          legend.key.width = unit(4.5, "mm"),
          legend.key.height = unit(7, "mm"),
          plot.caption = element_text(size = 10, hjust = 0.2, margin = margin(t=15))) +
  guides(color = guide_legend(override.aes = list(size=.3))) +
  ggtitle("Dependent Variable: Change in Public Democratic Support") +
  labs(caption = apsr_caption)
```
